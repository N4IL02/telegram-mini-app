<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
<meta name="theme-color" content="#0b1320" />
<title>Speed & Cash Signal</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
  :root {
    --bg-color: #0b1320;
    --neon-blue: #007aff;
    --neon-orange: #ff9500;
    --text-white: #ffffff;
  }

  * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
  
  body {
    margin: 0;
    background-color: var(--bg-color);
    font-family: 'Inter', sans-serif;
    color: var(--text-white);
    display: flex;
    justify-content: center;
    padding: 16px;
    min-height: 100vh;
  }

  .app-shell {
    width: 100%;
    max-width: 460px;
    display: flex;
    flex-direction: column;
    gap: 16px;
  }

  /* --- ОБНОВЛЕННАЯ ВЕРХНЯЯ ПАНЕЛЬ (как на скрине) --- */
  .top-bar {
    background: #111a2b; /* Темный фон панели */
    border: 1px solid rgba(53, 208, 255, 0.15);
    border-radius: 20px; /* Сильные скругления */
    padding: 8px 10px;
    display: flex;
    align-items: center;
    gap: 10px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
  }

  .back-btn {
    background: #1a273a;
    border: 1px solid rgba(255,255,255,0.1);
    border-radius: 12px;
    padding: 8px 16px;
    color: white;
    text-decoration: none;
    font-weight: 700;
    font-size: 14px;
    display: flex;
    align-items: center;
    gap: 6px;
    transition: background 0.2s;
  }
  .back-btn:active { background: #25344d; }
  
  /* Стрелочка назад */
  .back-icon { width: 8px; height: 12px; fill: white; }

  .profile-icon {
    width: 32px; height: 32px;
    border-radius: 50%;
    background: #2b8bff; /* Подложка если нет картинки */
  }

  .bot-name {
    font-weight: 800;
    font-size: 16px;
    letter-spacing: 0.3px;
  }

  /* --- ИГРОВАЯ КАРТОЧКА --- */
  .game-card {
    background: #121212;
    border: 1px solid rgba(255,255,255,0.08);
    border-radius: 20px;
    overflow: hidden;
    position: relative;
    box-shadow: 0 20px 50px rgba(0,0,0,0.6);
    display: flex;
    flex-direction: column;
  }

  /* Поле с дорогой */
  .track-container {
    height: 280px;
    position: relative;
    display: flex;
    /* Яркий фон, без затемнения */
    background: radial-gradient(circle at center, #1a1a1a 0%, #000000 100%);
    overflow: hidden;
  }

  /* Разметка дороги */
  .center-line {
    position: absolute;
    left: 50%; top: -50%; bottom: -50%;
    width: 4px;
    background: linear-gradient(to bottom, transparent 50%, rgba(255,255,255,0.3) 50%);
    background-size: 100% 60px;
    transform: translateX(-50%);
    z-index: 1;
  }
  /* Анимация движения */
  .animating .center-line {
    animation: roadMove 0.3s linear infinite;
  }

  /* Полосы машин */
  .lane {
    flex: 1;
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-end;
    padding-bottom: 30px;
    z-index: 2;
  }

  /* Текст коэффициентов (яркий неон) */
  .multiplier-wrap {
    position: absolute; top: 50px;
    font-size: 48px; font-weight: 900;
    z-index: 10;
    opacity: 0.8; /* Начальная прозрачность */
    transition: transform 0.2s, opacity 0.2s;
  }
  .blue-text { 
    color: var(--neon-blue); 
    text-shadow: 0 0 20px rgba(0, 122, 255, 0.6); 
  }
  .orange-text { 
    color: var(--neon-orange); 
    text-shadow: 0 0 20px rgba(255, 149, 0, 0.6); 
  }

  /* Увеличиваем и делаем ярче при анимации */
  .animating .multiplier-wrap { opacity: 1; transform: scale(1.05); }

  /* Контейнер машины */
  .car-box {
    width: 60px; height: 110px;
    position: relative;
    transition: transform 0.3s ease;
  }
  
  .car-svg {
    width: 100%; height: 100%;
    filter: drop-shadow(0 10px 20px rgba(0,0,0,0.8));
  }

  /* Тряска машин */
  .animating .car-box {
    animation: rumble 0.1s infinite alternate;
  }
  
  /* Огонь из выхлопной трубы */
  .boost-fx {
    position: absolute; bottom: -15px; left: 50%; transform: translateX(-50%);
    width: 24px; height: 50px;
    background: linear-gradient(to bottom, #fff, transparent);
    opacity: 0;
    filter: blur(4px);
    border-radius: 50%;
  }
  .animating .boost-fx { opacity: 0.9; }
  .blue-car .boost-fx { background: linear-gradient(to bottom, var(--neon-blue), transparent); }
  .orange-car .boost-fx { background: linear-gradient(to bottom, var(--neon-orange), transparent); }

  /* Кнопки управления */
  .controls-area {
    padding: 16px;
    background: #1a1a1a;
    border-top: 1px solid rgba(255,255,255,0.05);
  }

  .main-btn {
    width: 100%; height: 56px;
    border: none; border-radius: 12px;
    background: linear-gradient(90deg, var(--neon-blue) 0%, #005ec4 100%);
    color: white; font-size: 18px; font-weight: 800; text-transform: uppercase;
    cursor: pointer; position: relative; overflow: hidden;
    box-shadow: 0 4px 20px rgba(0, 122, 255, 0.4);
    transition: transform 0.1s;
  }
  .main-btn:active { transform: scale(0.98); }
  
  .spinner {
    width: 24px; height: 24px; border: 3px solid #fff;
    border-top-color: transparent; border-radius: 50%;
    margin: 0 auto;
    animation: spin 0.8s linear infinite;
    display: none;
  }

  @keyframes roadMove { from { background-position: 0 0; } to { background-position: 0 60px; } }
  @keyframes rumble { 0% { transform: translateY(0) translateX(-1px); } 100% { transform: translateY(2px) translateX(1px); } }
  @keyframes spin { to { transform: rotate(360deg); } }

</style>
</head>
<body>

<div class="app-shell">
  <div class="top-bar">
    <a href="index.html" class="back-btn">
      <svg class="back-icon" viewBox="0 0 10 16"><path d="M9 1L2 8L9 15" stroke="currentColor" stroke-width="2" fill="none"/></svg>
      Back
    </a>
    <img src="telegram_icon.png" alt="TG" class="profile-icon">
    <div class="bot-name">@master_mines_bot</div>
  </div>

  <div class="game-card" id="gameCard">
    
    <div class="track-container">
      <div class="center-line"></div>

      <div class="lane blue-car">
        <div class="multiplier-wrap blue-text" id="valBlue">x1.00</div>
        <div class="car-box">
          <svg class="car-svg" viewBox="0 0 100 200">
            <path fill="#005ec4" d="M15,40 Q15,10 50,10 Q85,10 85,40 L85,160 Q85,190 50,190 Q15,190 15,160 Z" />
            <path fill="#003f8a" d="M20,50 L80,50 L80,100 L20,100 Z" opacity="0.5"/>
            <path fill="#007aff" d="M20,110 L80,110 L80,150 L20,150 Z" opacity="0.6"/>
            <rect x="10" y="130" width="5" height="30" rx="2" fill="#000" />
            <rect x="85" y="130" width="5" height="30" rx="2" fill="#000" />
            <rect x="10" y="40" width="5" height="30" rx="2" fill="#000" />
            <rect x="85" y="40" width="5" height="30" rx="2" fill="#000" />
            <div class="boost-fx"></div>
          </svg>
        </div>
      </div>

      <div class="lane orange-car">
        <div class="multiplier-wrap orange-text" id="valOrange">x1.00</div>
        <div class="car-box">
           <svg class="car-svg" viewBox="0 0 100 200">
            <path fill="#cc7a00" d="M15,40 Q15,10 50,10 Q85,10 85,40 L85,160 Q85,190 50,190 Q15,190 15,160 Z" />
            <path fill="#8a5300" d="M20,50 L80,50 L80,100 L20,100 Z" opacity="0.5"/>
            <path fill="#ff9500" d="M20,110 L80,110 L80,150 L20,150 Z" opacity="0.6"/>
            <rect x="10" y="130" width="5" height="30" rx="2" fill="#000" />
            <rect x="85" y="130" width="5" height="30" rx="2" fill="#000" />
            <rect x="10" y="40" width="5" height="30" rx="2" fill="#000" />
            <rect x="85" y="40" width="5" height="30" rx="2" fill="#000" />
            <div class="boost-fx"></div>
          </svg>
        </div>
      </div>

    </div>

    <div class="controls-area">
      <button class="main-btn" id="predictBtn">
        <span id="btnText">GET SIGNAL</span>
        <div class="spinner" id="spinner"></div>
      </button>
    </div>

  </div>
</div>

<script>
  if (window.Telegram && Telegram.WebApp) Telegram.WebApp.expand();

  const gameCard = document.getElementById('gameCard');
  const predictBtn = document.getElementById('predictBtn');
  const btnText = document.getElementById('btnText');
  const spinner = document.getElementById('spinner');
  const valBlue = document.getElementById('valBlue');
  const valOrange = document.getElementById('valOrange');

  let isRunning = false;

  // Логика рандома
  function getResult() {
    // 0 = обе далеко, 1 = синяя вин, 2 = оранжевая вин, 3 = обе рано
    const scenario = Math.floor(Math.random() * 4);
    let b, o;
    
    if (scenario === 0) { 
      b = (2.0 + Math.random() * 5).toFixed(2);
      o = (2.0 + Math.random() * 5).toFixed(2);
    } else if (scenario === 1) { 
      b = (3.0 + Math.random() * 10).toFixed(2);
      o = (1.0 + Math.random() * 0.9).toFixed(2);
    } else if (scenario === 2) { 
      b = (1.0 + Math.random() * 0.9).toFixed(2);
      o = (3.0 + Math.random() * 10).toFixed(2);
    } else { 
      b = (1.1 + Math.random() * 0.9).toFixed(2);
      o = (1.1 + Math.random() * 0.9).toFixed(2);
    }
    return { blue: b, orange: o };
  }

  predictBtn.addEventListener('click', () => {
    if (isRunning) return;
    isRunning = true;

    // UI загрузка
    btnText.style.display = 'none';
    spinner.style.display = 'block';
    predictBtn.style.opacity = 0.8;
    
    // Сброс значений
    valBlue.innerText = "x1.00";
    valOrange.innerText = "x1.00";

    setTimeout(() => {
      // Старт гонки
      gameCard.classList.add('animating');
      spinner.style.display = 'none';
      btnText.style.display = 'block';
      btnText.innerText = "RACING...";

      const target = getResult();
      let currentB = 1.00;
      let currentO = 1.00;
      
      const interval = setInterval(() => {
        // Синий
        if(currentB < target.blue) {
          currentB += 0.05 + Math.random() * 0.15;
          if(currentB > target.blue) currentB = parseFloat(target.blue);
          valBlue.innerText = "x" + currentB.toFixed(2);
        }
        // Оранжевый
        if(currentO < target.orange) {
          currentO += 0.05 + Math.random() * 0.15;
          if(currentO > target.orange) currentO = parseFloat(target.orange);
          valOrange.innerText = "x" + currentO.toFixed(2);
        }

        // Финиш
        if(currentB >= target.blue && currentO >= target.orange) {
          clearInterval(interval);
          finishRace(target);
        }
      }, 50);

    }, 800);
  });

  function finishRace(target) {
    gameCard.classList.remove('animating');
    isRunning = false;
    btnText.innerText = "GET SIGNAL";
    predictBtn.style.opacity = 1;
    
    // Финальная установка точных значений
    valBlue.innerText = "x" + target.blue;
    valOrange.innerText = "x" + target.orange;
  }
</script>

</body>
</html>